<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Solving and Graphing Systems of Linear Equations</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="An Introduction to Matrix Computations in Python">
<meta property="book:author" content="Nicole Seaders and Claire Burke">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "https://pretextbook.org/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "pre.sagecell-sage",
  "linked": true,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script><script>// Make *any* pre with class 'sagecell-python' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "pre.sagecell-python",
  "linked": true,
  "languages": [
    "python"
  ],
  "evalButtonText": "Evaluate (Python)"
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="https://pretextbook.org/js/0.3/pretext_search.js"></script><link href="https://pretextbook.org/css/0.7/pretext_search.css" rel="stylesheet" type="text/css">
<script>js_version = 0.3</script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.3/pretext.js"></script><script>miniversion=0.1</script><script src="https://pretextbook.org/js/0.3/pretext_add_on.js?x=1"></script><script src="https://pretextbook.org/js/0.3/user_preferences.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&amp;family=Noto+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;family=Tinos:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
<link href="https://fonts.cdnfonts.com/css/dejavu-serif" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Serif:opsz,wdth,wght@8..144,50..150,100..900&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wdth,wght@75..100,300..800&amp;display=swap" rel="stylesheet">
<link href="https://pretextbook.org/css/0.7/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.7/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.7/shell_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.7/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.7/navbar_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.7/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.7/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.7/style_oscarlevin.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.7/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.7/setcolors.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="external/custom.css">
</head>
<body class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner">
<a id="logo-link" class="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="Matrix-Computations.html"><span class="title">An Introduction to Matrix Computations in Python:</span> <span class="subtitle">Just the basics</span></a></h1>
<p class="byline">Nicole Seaders and Claire Burke</p>
</div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<button id="closesearchresults" class="closesearchresults" onclick="document.getElementById('searchresultsplaceholder').style.display = 'none'; return false;">x</button><h2>Search Results: <span id="searchterms" class="searchterms"></span>
</h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><button class="toc-toggle button" aria-label="Show or hide table of contents"><span class="icon">‚ò∞</span><span class="name">Contents</span></button><button id="user-preferences-button" class="user-preferences-button button" title="Modify user preferences"><span id="avatarbutton" class="avatarbutton name">You!</span><div id="preferences_menu_holder" class="preferences_menu_holder hidden"><ol id="preferences_menu" class="preferences_menu" style="font-family: 'Roboto Serif', serif;">
<li data-env="avatar" tabindex="-1">Choose avatar<div class="wrap_to_submenu"><span class="to_submenu">‚ñª</span></div>
<ol class="hidden avatar">
<li data-val="You!" tabindex="-1">
<span id="theYou!" class="avatarcheck">‚úîÔ∏è</span>You!</li>
<li data-val="üò∫" tabindex="-1">
<span id="theüò∫" class="avatarcheck"></span>üò∫</li>
<li data-val="üë§" tabindex="-1">
<span id="theüë§" class="avatarcheck"></span>üë§</li>
<li data-val="üëΩ" tabindex="-1">
<span id="theüëΩ" class="avatarcheck"></span>üëΩ</li>
<li data-val="üê∂" tabindex="-1">
<span id="theüê∂" class="avatarcheck"></span>üê∂</li>
<li data-val="üêº" tabindex="-1">
<span id="theüêº" class="avatarcheck"></span>üêº</li>
<li data-val="üåà" tabindex="-1">
<span id="theüåà" class="avatarcheck"></span>üåà</li>
</ol>
</li>
<li data-env="fontfamily" tabindex="-1">Font family<div class="wrap_to_submenu"><span class="to_submenu">‚ñª</span></div>
<ol class="hidden fontfamily">
<li data-val="face" data-change="OS" tabindex="-1" style="font-family: 'Open Sans'">
<span id="theOS" class="ffcheck">‚úîÔ∏è</span><span class="name">Open Sans</span><span class="sample">AaBbCc 123 PreTeXt</span>
</li>
<li data-val="face" data-change="RS" tabindex="-1" style="font-family: 'Roboto Serif'">
<span id="theRS" class="ffcheck"></span><span class="name">Roboto Serif</span><span class="sample">AaBbCc 123 PreTeXt</span>
</li>
</ol>
</li>
<li data-env="font" tabindex="-1">Adjust font<div class="wrap_to_submenu"><span class="to_submenu">‚ñª</span></div>
<ol class="hidden fonts">
<li>Size</li>
<li><span id="thesize">12</span></li>
<li data-val="size" data-change="-1" tabindex="-1" style="font-size: 80%">Smaller</li>
<li data-val="size" data-change="1" tabindex="-1" style="font-size: 110%">Larger</li>
<li>Width</li>
<li><span id="thewdth">100</span></li>
<li data-val="wdth" data-change="-5" tabindex="-1" style="font-variation-settings: 'wdth' 60">narrower</li>
<li data-val="wdth" data-change="5" tabindex="-1" style="font-variation-settings: 'wdth' 150">wider</li>
<li>Weight</li>
<li><span id="thewght">400</span></li>
<li data-val="wght" data-change="-50" tabindex="-1" style="font-weight: 200">thinner</li>
<li data-val="wght" data-change="50" tabindex="-1" style="font-weight: 700">heavier</li>
<li>Letter spacing</li>
<li>
<span id="thelspace">0</span><span class="byunits">/200</span>
</li>
<li data-val="lspace" data-change="-1" tabindex="-1">closer</li>
<li data-val="lspace" data-change="1" tabindex="-1">f a r t h e r</li>
<li>Word spacing</li>
<li>
<span id="thewspace">0</span><span class="byunits">/50</span>
</li>
<li data-val="wspace" data-change="-1" tabindex="-1">smaller‚ÄÖgap‚ÄÉ</li>
<li data-val="wspace" data-change="1" tabindex="-1">larger‚ÄÉgap</li>
<li>Line Spacing</li>
<li>
<span id="theheight">135</span><span class="byunits">/100</span>
</li>
<li data-val="height" data-change="-5" tabindex="-1" style="line-height: 1">closer<br>together</li>
<li data-val="height" data-change="5" tabindex="-1" style="line-height: 1.75">further<br>apart</li>
</ol>
</li>
<li data-env="atmosphere" tabindex="-1">Light/dark mode<div class="wrap_to_submenu"><span class="to_submenu">‚ñª</span></div>
<ol class="hidden atmosphere">
<li data-val="default" tabindex="-1">
<span id="thedefault" class="atmospherecheck">‚úîÔ∏è</span>default</li>
<li data-val="pastel" tabindex="-1">
<span id="thepastel" class="atmospherecheck"></span>pastel</li>
<li data-val="darktwilight" tabindex="-1">
<span id="thedarktwilight" class="atmospherecheck"></span>twilight</li>
<li data-val="dark" tabindex="-1">
<span id="thedark" class="atmospherecheck"></span>dark</li>
<li data-val="darkmidnight" tabindex="-1">
<span id="thedarkmidnight" class="atmospherecheck"></span>midnight</li>
</ol>
</li>
<li data-env="ruler" tabindex="-1">Reading ruler<div class="wrap_to_submenu"><span class="to_submenu">‚ñª</span></div>
<ol class="hidden ruler">
<li data-val="none" tabindex="-1">
<span id="thenone" class="rulercheck">‚úîÔ∏è</span>none</li>
<li data-val="underline" tabindex="-1">
<span id="theunderline" class="rulercheck"></span>underline</li>
<li data-val="lunderline" tabindex="-1">
<span id="thelunderline" class="rulercheck"></span>L-underline</li>
<li data-val="greybar" tabindex="-1">
<span id="thegreybar" class="rulercheck"></span>grey bar</li>
<li data-val="lightbox" tabindex="-1">
<span id="thelightbox" class="rulercheck"></span>light box</li>
<li data-val="sunrise" tabindex="-1">
<span id="thesunrise" class="rulercheck"></span>sunrise</li>
<li data-val="sunriseunderline" tabindex="-1">
<span id="thesunriseunderline" class="rulercheck"></span>sunrise underline</li>
<li class="moveQ">Motion by:</li>
<li data-val="mouse" tabindex="-1">
<span id="themouse" class="motioncheck">‚úîÔ∏è</span>follow the mouse</li>
<li data-val="arrow" tabindex="-1">
<span id="thearrow" class="motioncheck"></span>up/down arrows - not yet</li>
<li data-val="eye" tabindex="-1">
<span id="theeye" class="motioncheck"></span>eye tracking - not yet</li>
</ol>
</li>
</ol></div></button><span class="treebuttons"><a class="previous-button button" href="chapter2.html" title="Previous"><span class="icon">&lt;</span><span class="name">Prev</span></a><a class="up-button button" href="chapter2.html" title="Up"><span class="icon">^</span><span class="name">Up</span></a><a class="next-button button" href="section-matrices.html" title="Next"><span class="name">Next</span><span class="icon">&gt;</span></a></span><div class="searchbox"><div class="searchwidget">
<input id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search" onchange="doSearch()"><button id="searchbutton" class="searchbutton" type="button" onclick="doSearch()">üîç</button>
</div></div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\R}{\mathbb R}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2"><ul class="structural">
<li><div class="toc-item"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li><div class="toc-item"><a href="prologue.html" class="internal"><span class="codenumber">0</span> <span class="title">Prologue</span></a></div></li>
<li>
<div class="toc-item"><a href="chapter1.html" class="internal"><span class="codenumber">1</span> <span class="title">Basics, Modules, and Graphing</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="section-variables.html" class="internal"><span class="codenumber">1.1</span> <span class="title">Variables</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="section-variables.html#subsection-1" class="internal"><span class="title"></span></a></div></li>
<li><div class="toc-item"><a href="section-variables.html#subsec-naming-variables" class="internal"><span class="title">Naming Variables</span></a></div></li>
<li><div class="toc-item"><a href="section-variables.html#subsec_comments_in_Python" class="internal"><span class="title">Arithmetic and Comments in Python</span></a></div></li>
<li><div class="toc-item"><a href="section-variables.html#subsec_more_vars" class="internal"><span class="title">More about Variables</span></a></div></li>
<li><div class="toc-item"><a href="section-variables.html#subsec_errors" class="internal"><span class="title">Syntax and Semantic errors</span></a></div></li>
<li><div class="toc-item"><a href="section-variables.html#exercises-variable" class="internal"><span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="section-modules.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Python Packages and NumPy</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="section-modules.html#subsection-6" class="internal"><span class="title">Importing the package NumPy</span></a></div></li>
<li><div class="toc-item"><a href="section-modules.html#subsection-7" class="internal"><span class="title">Standard functions in NumPy</span></a></div></li>
<li><div class="toc-item"><a href="section-modules.html#subsection-8" class="internal"><span class="title">NumPy arrays</span></a></div></li>
<li><div class="toc-item"><a href="section-modules.html#exercises-modules" class="internal"><span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="section-matplotlib.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Matplotlib and 2D graphing</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="section-matplotlib.html#subsec-figures" class="internal"><span class="title">Creating a graph or plot</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib.html#subsection-10" class="internal"><span class="title">Curves in 2D</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib.html#subsec-scatterplots" class="internal"><span class="title">Scatter Plots in 2D</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib.html#subsection-12" class="internal"><span class="title">Parametric Curves in 2D</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib.html#labels" class="internal"><span class="title">Titles and Axes Labels</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib.html#custom-graphs" class="internal"><span class="title">Customizing</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib.html#subsec-Vectorsin2D" class="internal"><span class="title">Vectors in 2D</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib.html#subsec-subplots" class="internal"><span class="title">Multiple plots in the same figure</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib.html#exercises-matplotlib2D" class="internal"><span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="section-matplotlib3d.html" class="internal"><span class="codenumber">1.4</span> <span class="title">Matplotlib and 3D graphing</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="section-matplotlib3d.html#subsec-3Daxes" class="internal"><span class="title">3D axes</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib3d.html#subsec-3DParam" class="internal"><span class="title">Parametric Curves in 3D</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib3d.html#subsec-Graphing-a-surface" class="internal"><span class="title">Surfaces and scatterplots in 3D</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib3d.html#subsec-3DAxesandLabels" class="internal"><span class="title">Axes and Labels</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib3d.html#subsec-multiplesurfaces" class="internal"><span class="title">Plotting Multiple Surfaces</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib3d.html#subsection-22" class="internal"><span class="title">Customizing</span></a></div></li>
<li><div class="toc-item"><a href="section-matplotlib3d.html#exercises-matplotlib3D" class="internal"><span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="section-animation.html" class="internal"><span class="codenumber">1.5</span> <span class="title">Basic Animation</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="section-animation.html#subsection-23" class="internal"><span class="title">Animating in Matplotlib</span></a></div></li>
<li><div class="toc-item"><a href="section-animation.html#exercises-animation" class="internal"><span class="title">Exercises</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="chapter2.html" class="internal"><span class="codenumber">2</span> <span class="title">Matrix Algebra in Python</span></a></div>
<ul class="structural">
<li class="active">
<div class="toc-item"><a href="section-systems.html" class="internal"><span class="codenumber">2.1</span> <span class="title">Solving and Graphing Systems of Linear Equations</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="section-systems.html#rref" class="internal"><span class="title">Row Reduction</span></a></div></li>
<li><div class="toc-item"><a href="section-systems.html#graphsolution" class="internal"><span class="title">Graphing solutions to systems of equations</span></a></div></li>
<li><div class="toc-item"><a href="section-systems.html#subsection-26" class="internal"><span class="title">Graphing vector equations and their solutions</span></a></div></li>
<li><div class="toc-item"><a href="section-systems.html#subsec-" class="internal"><span class="title">Converting between Numpy arrays and Sympy Matrices</span></a></div></li>
<li><div class="toc-item"><a href="section-systems.html#subsecRoundingErrorRref" class="internal"><span class="title">Round-off error in Sympy‚Äôs rref()</span></a></div></li>
<li><div class="toc-item"><a href="section-systems.html#exercises-systems" class="internal"><span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="section-matrices.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Matrix Arithmetic</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="section-matrices.html#subsection-29" class="internal"><span class="title">NumPy vs SymPy</span></a></div></li>
<li><div class="toc-item"><a href="section-matrices.html#subsec-BasicMatrices" class="internal"><span class="title">Basic Matrices</span></a></div></li>
<li><div class="toc-item"><a href="section-matrices.html#subsec-MatrixArithmetic" class="internal"><span class="title">Matrix Arithmetic</span></a></div></li>
<li><div class="toc-item"><a href="section-matrices.html#subsec-MatrixMultiplication" class="internal"><span class="title">Matrix Multiplication</span></a></div></li>
<li><div class="toc-item"><a href="section-matrices.html#subsec-MatrixInverses" class="internal"><span class="title">Matrix Inverses</span></a></div></li>
<li><div class="toc-item"><a href="section-matrices.html#subsec-solving-with-inverses" class="internal"><span class="title">Solving Matrix Equations via Inverses</span></a></div></li>
<li><div class="toc-item"><a href="section-matrices.html#subsec-ill-conditioned" class="internal"><span class="title">Ill-Conditioned Matrices</span></a></div></li>
<li><div class="toc-item"><a href="section-matrices.html#exercises-matrices" class="internal"><span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="section-transformations.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Matrix Transformations</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="section-transformations.html#subsec-ComputingMatrixTransformations" class="internal"><span class="title">Computing Matrix Transformations</span></a></div></li>
<li><div class="toc-item"><a href="section-transformations.html#subsection-37" class="internal"><span class="title">Visualizing a Matrix Transformation</span></a></div></li>
<li><div class="toc-item"><a href="section-transformations.html#subsection-38" class="internal"><span class="title">Animating Matrix Transformations</span></a></div></li>
<li><div class="toc-item"><a href="section-transformations.html#exercises-transformations" class="internal"><span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="section-determinants.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Determinants</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="section-determinants.html#subsec-what-is-determinant" class="internal"><span class="title">What is the determinant?</span></a></div></li>
<li><div class="toc-item"><a href="section-determinants.html#subsec-computing-determinant" class="internal"><span class="title">Computing the Determinant</span></a></div></li>
<li><div class="toc-item"><a href="section-determinants.html#subsec-determinants-linear-systems" class="internal"><span class="title">Determinants and Systems of Linear Equations</span></a></div></li>
<li><div class="toc-item"><a href="section-determinants.html#subsec-numerical-solve" class="internal"><span class="title">Numerically Solving System of Equations</span></a></div></li>
<li><div class="toc-item"><a href="section-determinants.html#subsec-Ill-conditionedTransformations" class="internal"><span class="title">Ill-conditioned Matrices</span></a></div></li>
<li><div class="toc-item"><a href="section-determinants.html#exercises-determinants" class="internal"><span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="section-eigenthings.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Eigenthings</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="section-eigenthings.html#subsec-computing-eigenthings" class="internal"><span class="title">Computing Eigenthings</span></a></div></li>
<li><div class="toc-item"><a href="section-eigenthings.html#subsec-visualizing-eigenthings" class="internal"><span class="title">Visualizing with Eigenthings</span></a></div></li>
<li><div class="toc-item"><a href="section-eigenthings.html#subsec-Diagonalization" class="internal"><span class="title">Diagonalization</span></a></div></li>
<li><div class="toc-item"><a href="section-eigenthings.html#subsec-complex-decomposition" class="internal"><span class="title">Complex Eigen-thing Decomposition</span></a></div></li>
<li><div class="toc-item"><a href="section-eigenthings.html#exercises-eigenthings" class="internal"><span class="title">Exercises</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="appendix.html" class="internal"><span class="codenumber">3</span> <span class="title">Appendix</span></a></div>
<ul class="structural"><li>
<div class="toc-item"><a href="examples.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Samples of various pretext formats</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="examples.html#subsection-48" class="internal"><span class="title">What happens if I do this?</span></a></div></li>
<li><div class="toc-item"><a href="examples.html#reading-questions-1" class="internal"><span class="title">Reading Questions</span></a></div></li>
</ul>
</li></ul>
</li>
<li><div class="toc-item"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content">
<section class="section" id="section-systems"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">2.1</span> <span class="title">Solving and Graphing Systems of Linear Equations</span>
</h2>
<section class="introduction" id="introduction-9">Systems of linear equations can be solved using multiple methods. In this section we will learn how to solve systems of linear equations using a process called row reduction. <a href="" data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-5" id="fn-5"><sup>‚Äâ1‚Äâ</sup></a></section><article class="objectives goal-like" id="objectives-6"><h3 class="heading"><span class="type">Objectives</span></h3>
<ul class="disc">
<li id="li-66"><div class="para" id="p-185">Row reduce matrices representing systems of linear equations using the Python library Sympy.</div></li>
<li id="li-67"><div class="para" id="p-186">Graph solutions to systems of linear equations of two or three variables.</div></li>
<li id="li-68"><div class="para" id="p-187">Graph solutions to vector equations in <span class="process-math">\(\mathbb{R}^2\)</span> and <span class="process-math">\(\mathbb{R}^3\text{.}\)</span>
</div></li>
<li id="li-69"><div class="para" id="p-188">Use the pivots of a reduced augmented matrix to determine if a system has no solution, a unique solution, or infinitely many solutions</div></li>
</ul></article><section class="subsection" id="rref"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber"></span> <span class="title">Row Reduction</span>
</h3>
<div class="para" id="p-189">Note that row reduction involves symbolic manipulation. Since Numpy is focused on number crunching, we will need a different Python library called Sympy to do the symbolic manipulation of row reduction to reduced echelon form and row reduced echelon form.</div>
<div class="para" id="p-190">In order to row reduce a system of linear equations we convert our system into an augmented matrix.</div>
<article class="example example-like" id="augmatrix"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.1</span><span class="period">.</span><span class="space"> </span><span class="title">Augmented Matrix.</span>
</h4>
<div class="para logical" id="p-191">
<div class="para">For example, the system</div>
<div class="displaymath process-math" id="md-2">
\begin{align*}
2x \amp -3y \amp= 4 \\
x \amp +4y \amp =2
\end{align*}
</div>
<div class="para">becomes</div>
<div class="displaymath process-math">
\begin{equation*}
\left[
\begin{matrix}
2 \amp -3 \amp | \amp 4\\
1 \amp 4 \amp | \amp 2
\end{matrix}
\right].
\end{equation*}
</div>
</div></article><div class="para" id="p-192">In Sympy, matrices are entered using the function <code class="code-inline tex2jax_ignore">Matrix</code>.</div>
<pre class="ptx-sagecell sagecell-python" id="sage-48"><script type="text/x-sage">import sympy as sp

#define your sympy matrix
A = sp.Matrix([
  [1,2,3],
  [4,5,6]]) 

print(A)
</script></pre>
<article class="exercise exercise-like" id="exercise-44"><h4 class="heading">
<span class="type">You Try</span><span class="space"> </span><span class="codenumber">2.2</span><span class="period">.</span>
</h4>
<div class="para" id="p-193">Edit the above code to print the augmented matrix for the system of linear equations in <a href="" class="xref" data-knowl="./knowl/augmatrix.html" title="Example 2.1: Augmented Matrix">Example¬†2.1</a>.</div></article><div class="para" id="p-194">Note that sympy will automatically convert decimals to floating point numbers. Often it is helpful to keep fractions exact using sympy‚Äôs <code class="code-inline tex2jax_ignore">Rational(a,b)</code> command.</div>
<article class="exercise exercise-like" id="exercise-45"><h4 class="heading">
<span class="type">You Try</span><span class="space"> </span><span class="codenumber">2.3</span><span class="period">.</span>
</h4>
<div class="para" id="p-195">Edit the above code to print a matrix with decimals like <span class="process-math">\(0.9\)</span> or <span class="process-math">\(0.1\text{.}\)</span> Also print a matrix with fractions like <span class="process-math">\(\frac{9}{10}\)</span> and <span class="process-math">\(\frac{1}{10}\)</span> using sympy‚Äôs <code class="code-inline tex2jax_ignore">Rational(a,b)</code> command.</div>
<a href="" data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-6" id="hint-6"><span class="type">Hint</span><span class="period">.</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-6"><div class="hint solution-like"><div class="para" id="p-196">Note that <code class="code-inline tex2jax_ignore">Rational(a,b)</code> is not a Python command, but rather a command specific to Sympy.</div></div></div></article><div class="para" id="p-197">The Sympy functions <code class="code-inline tex2jax_ignore">echelon_form()</code> and <code class="code-inline tex2jax_ignore">rref()</code> can be used to row reduce a matrix to reduced echelon form and row reduced echelon form, respectively. If you need a refresher on these two forms, read <a class="external" href="https://textbooks.math.gatech.edu/ila/row-reduction.html" target="_blank">Section 1.2</a><a href="" data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-6" id="fn-6"><sup>‚Äâ2‚Äâ</sup></a> of Interactive Linear Algebra.</div>
<article class="exercise exercise-like" id="exercise-46"><h4 class="heading">
<span class="type">You Try</span><span class="space"> </span><span class="codenumber">2.4</span><span class="period">.</span>
</h4>
<div class="para" id="p-198">Edit the code below to print the reduced echelon form and the row reduced echelon form for the augmented matrix of the system of linear equations from <a href="" class="xref" data-knowl="./knowl/augmatrix.html" title="Example 2.1: Augmented Matrix">Example¬†2.1</a>.</div></article><pre class="ptx-sagecell sagecell-python" id="sage-49"><script type="text/x-sage">import sympy as sp

#define your sympy matrix
A = sp.Matrix([ [2,-3,4], [1,4,2]]) 

print(A.echelon_form()) #print REF of A
print(A.rref()) #print RREF of A
</script></pre>
<div class="para" id="p-199">Note that <code class="code-inline tex2jax_ignore">rref()</code> returns not only the row reduced echelon form of a matrix, but also a tuple that tells you which columns have leading values of 1 (where the left-most column is column 0). These columns are called pivot columns, and give you a quick way to see any free variables (which are non-pivot columns).</div>
<article class="exercise exercise-like" id="exercise-47"><h4 class="heading">
<span class="type">You Try</span><span class="space"> </span><span class="codenumber">2.5</span><span class="period">.</span>
</h4>
<div class="para" id="p-200">Edit the code above for various augmented matrices to see how the tuple returned by <code class="code-inline tex2jax_ignore">rref()</code> relates to the pivot columns.</div></article><div class="para logical" id="p-201">
<div class="para">Recall that a system of linear equations either has</div>
<ol class="decimal">
<li id="li-70"><div class="para" id="p-202">no solution,</div></li>
<li id="li-71"><div class="para" id="p-203">a unique solution, or</div></li>
<li id="li-72"><div class="para" id="p-204">infinitely many solutions.</div></li>
</ol>
<div class="para">If you need a refresher on how to interpret the reduced echelon form of an augmented matrix to determine if there is no solution, write down the unique solution, or give the infinitely many solutions in parametric form, see MTH 264 class notes Lesson 3.</div>
</div></section><section class="subsection" id="graphsolution"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber"></span> <span class="title">Graphing solutions to systems of equations</span>
</h3>
<div class="para" id="p-205">In order to graph solutions to systems of linear equations with two or three variables you can graph the corresponding lines, planes, or coordinates.</div>
<article class="example example-like" id="twodsolutions"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.6</span><span class="period">.</span>
</h4>
<div class="para logical" id="p-206">
<div class="para">The system</div>
<div class="displaymath process-math" id="md-3">
\begin{align*}
x \amp +2y \amp= 6 \\
\frac{1}{2}x \amp -y \amp =1
\end{align*}
</div>
<div class="para">has solutions <span class="process-math">\(x=4\)</span> and <span class="process-math">\(y=1\text{.}\)</span>
</div>
</div> <div class="para" id="p-207">Linear equations with two variables can be graphed as lines in the xy-plane, either by plotting two points on the line or solving for <span class="process-math">\(y\text{.}\)</span> The solution is one point in a scatter plot.</div> <pre class="ptx-sagecell sagecell-python" id="sage-50"><script type="text/x-sage">import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure() #create a figure
ax = plt.axes() #create an axis
ax.grid() #add a grid

X = np.linspace(0,10,num=100) #inputs
Y1 = (6-X)/2 #outputs for first equation
Y2 = 0.5*X-1 #outputs for second equation

#label title and axes
ax.set(title="Solutions to 2D System", xlabel="x", ylabel="y") 

ax.plot(X,Y1,X,Y2) #plot both equations
plt.show() #display result
</script></pre></article><article class="exercise exercise-like" id="exercise-48"><h4 class="heading">
<span class="type">You Try</span><span class="space"> </span><span class="codenumber">2.7</span><span class="period">.</span>
</h4>
<div class="para" id="p-208">Edit the code in <a href="" class="xref" data-knowl="./knowl/twodsolutions.html" title="Example 2.6">Example¬†2.6</a> to clearly indicate the solution <span class="process-math">\(x=4\)</span> and <span class="process-math">\(y=1\)</span> on the graph.</div></article><div class="para" id="p-209">Systems of equations with three variables must be graphed in 3D. As mentioned in <a href="section-matplotlib3d.html" class="internal" title="Section 1.4: Matplotlib and 3D graphing">Section¬†1.4</a>, Matplotlib paints 2D projections of each surface on top of the other which doesn‚Äôt adequately graph their relationships. We can partially fix this by making the surfaces transparent and explicitly plotting their intersections. The intersection of any two non-parallel planes is a line which can be found by solving the system of the two plane equations and writing the solution in parametric form.</div>
<article class="example example-like" id="threedsolutions1"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.8</span><span class="period">.</span>
</h4>
<div class="para logical" id="p-210">
<div class="para">Graph solutions to the system</div>
<div class="displaymath process-math" id="md-4">
\begin{align*}
x +y +z \amp= 1 \\
-y +z \amp =1\\
-x  +y -z\amp =0
\end{align*}
</div>
<div class="para">by finding the equations of the lines of intersection of the planes and plotting the planes, the lines, and the point of intersection.</div>
</div> <div class="para" id="p-211">Solution 1 walks through the process, followed by a Python implementation of the <code class="code-inline tex2jax_ignore">rref()</code>.</div> <a href="" data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-2" id="solution-2"><span class="type">Solution</span><span class="space"> </span><span class="codenumber">1</span><span class="period">.</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-2"><div class="solution solution-like">
<div class="para" id="p-212">First row reducing the augmented matrix for the system of all three equations we obtain a unique solution <span class="process-math">\(x=-1\text{,}\)</span> <span class="process-math">\(y=1/2\text{,}\)</span> <span class="process-math">\(z=3/2\text{.}\)</span>
</div> <div class="para logical" id="p-213">
<div class="para">Row reducing the augmented matrix for the first two equations we obtain</div>
<div class="displaymath process-math" id="md-5">
\begin{align*}
x +2z \amp= 2 \\
y -z \amp =-1
\end{align*}
</div>
<div class="para">which can be written in parametric form,</div>
<div class="displaymath process-math">
\begin{equation*}
\left[ \begin{matrix} x\\ y\\z \end{matrix} \right] =
\left[\begin{matrix} 2-2z\\ -1+z\\z \end{matrix} \right]=
\left[\begin{matrix} 2\\ -1\\0 \end{matrix} \right] +z\left[\begin{matrix} -2\\ 1\\1 \end{matrix} \right].
\end{equation*}
</div>
</div> <div class="para logical" id="p-214">
<div class="para">Row reducing the augmented matrix for the last two equations we obtain</div>
<div class="displaymath process-math" id="md-6">
\begin{align*}
x \amp= -1 \\
y -z \amp =-1
\end{align*}
</div>
<div class="para">which can be written in parametric form,</div>
<div class="displaymath process-math">
\begin{equation*}
\left[ \begin{matrix} x\\ y\\z \end{matrix} \right] =
\left[\begin{matrix} -1\\ -1+z\\z \end{matrix} \right]=
\left[\begin{matrix} -1\\ -1\\0 \end{matrix} \right] +z\left[\begin{matrix} 0\\ 1\\1 \end{matrix} \right].
\end{equation*}
</div>
</div> <div class="para logical" id="p-215">
<div class="para">Row reducing the augmented matrix for the first and last equations we obtain</div>
<div class="displaymath process-math" id="md-7">
\begin{align*}
x +z\amp= 1/2 \\
y  \amp =1/2
\end{align*}
</div>
<div class="para">which can be written in parametric form,</div>
<div class="displaymath process-math">
\begin{equation*}
\left[ \begin{matrix} x\\ y\\z \end{matrix} \right] =
\left[\begin{matrix} 1/2-z\\ 1/2\\z \end{matrix} \right]=
\left[\begin{matrix} 1/2\\ 1/2\\0 \end{matrix} \right] +z\left[\begin{matrix} -1\\ 0\\1 \end{matrix} \right].
\end{equation*}
</div>
</div>
</div></div> <pre class="ptx-sagecell sagecell-python" id="sage-51"><script type="text/x-sage">import sympy as sp

A = sp.Matrix([ [1,1,1,1], [0,-1,1,1],[-1,1,-1,0]
]) #all three equations

I1 = sp.Matrix([ [1,1,1,1], [0,-1,1,1]
]) #intersection first two equations

I2 = sp.Matrix([ [0,-1,1,1],[-1,1,-1,0]
]) #intersection last two other equations

I3 = sp.Matrix([ [1,1,1,1], [-1,1,-1,0]
]) #intersection first and last equations

print("A=", A.rref())
print("I1=", I1.rref())
print("I2=", I2.rref())
print("I3=", I3.rref())
</script></pre> <div class="para" id="p-216">Next we will use Matplotlib to graph these results. First note that if we are careless with our input domains for the planes and lines, our graph will be inconsistent.</div> <pre class="ptx-sagecell sagecell-python" id="sage-52"><script type="text/x-sage">import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure() #create a figure
ax = plt.axes(projection='3d') #add a 3D axis

#plot the 3 plane equations, use alpha for transparency
X = np.arange(-2,2,step=0.25) #1d x inputs
Y = np.arange(-2,2,step=0.25) #1d y inputs
X,Y = np.meshgrid(X,Y) #2D grid of inputs
Z1 = 1-X-Y
Z2 = 1+Y
Z3 = Y-X
ax.plot_surface(X,Y,Z1, alpha=0.5) 
ax.plot_surface(X,Y,Z2, alpha=0.5)
ax.plot_surface(X,Y,Z3, alpha=0.5)

#plot the solution
ax.scatter(-1,1/2,3/2)

#plot the 3 line equations
Z = np.arange(-2,2,step=0.25)
X1 = 2-2*Z
Y1 = -1+Z
X2 = -1+0*Z
Y2 = -1+Z
X3 = 0.5-Z
Y3 = 0.5+0*Z
ax.plot(X1,Y1,Z)
ax.plot(X2,Y2,Z)
ax.plot(X3,Y3,Z)

# Customize the view angle 
#ax.view_init(elev=20, azim=30, roll=0)

#set title and axes labels
ax.set(title="Solutions to 3D System", xlabel="x", ylabel="y", zlabel="z")

plt.show()
</script></pre> <div class="para" id="p-217">Note: you can change the viewing angle to try and get a better graph.</div> <div class="para" id="p-218">The real problem in the code above is that we graph our surfaces with domain <span class="process-math">\(-2\leq x \leq 2\)</span> and <span class="process-math">\(-2\leq y\leq 2\text{,}\)</span> but use <span class="process-math">\(-2\leq z\leq 2\)</span> for the parametric equation of our lines. There are several fixes for this.</div> <div class="para" id="p-219">One fix is to adjust the parametric input values for the lines to better match the planes. For example, you can make <span class="process-math">\(-1\leq z \leq 3\)</span> to get a more consistent graph. <em class="emphasis">Try several adjustments for the <span class="process-math">\(z\)</span> range in the above code.</em> To get a fully consistent graph, each line would need a different parametric domain that matches the domain of the planes.</div> <div class="para" id="p-220">Another fix is to solve each pair of equations for two points on the line in the domain of the planes. You can then plot the line between the two points.</div> <div class="para" id="p-221">Solution 2 walks through the process of finding the points, followed by an alternative Python implementation to graph the solutions.</div> <a href="" data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-3" id="solution-3"><span class="type">Solution</span><span class="space"> </span><span class="codenumber">2</span><span class="period">.</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-3"><div class="solution solution-like">
<div class="para logical" id="p-222">
<div class="para">Recall the first two equations intersect in the line</div>
<div class="displaymath process-math">
\begin{equation*}
\left[ \begin{matrix} x\\ y\\z \end{matrix} \right] =
\left[\begin{matrix} 2-2z\\ -1+z\\z \end{matrix} \right]=
\left[\begin{matrix} 2\\ -1\\0 \end{matrix} \right] +z\left[\begin{matrix} -2\\ 1\\1 \end{matrix} \right].
\end{equation*}
</div>
<div class="para">Solving for when <span class="process-math">\(x=2\text{,}\)</span> we see <span class="process-math">\(t=0\text{.}\)</span> Plugging <span class="process-math">\(t=0\)</span> into the parametric equation for the line we obtain the point <span class="process-math">\((2,-1,0)\text{.}\)</span> Similarly when <span class="process-math">\(x=-2\text{,}\)</span> we find <span class="process-math">\(t=2\text{,}\)</span> giving the point <span class="process-math">\((-2,1,2)\text{.}\)</span>
</div>
</div> <div class="para logical" id="p-223">
<div class="para">The last two equations intersect in the line</div>
<div class="displaymath process-math">
\begin{equation*}
\left[ \begin{matrix} x\\ y\\z \end{matrix} \right] =
\left[\begin{matrix} -1\\ -1+z\\z \end{matrix} \right]=
\left[\begin{matrix} -1\\ -1\\0 \end{matrix} \right] +z\left[\begin{matrix} 0\\ 1\\1 \end{matrix} \right].
\end{equation*}
</div>
<div class="para">Here <span class="process-math">\(x\)</span> is always <span class="process-math">\(-1\text{.}\)</span> Instead we solve for when <span class="process-math">\(y=-2\)</span> and <span class="process-math">\(2\text{.}\)</span> We find <span class="process-math">\(t=-1\)</span> and <span class="process-math">\(3\text{,}\)</span> giving us the two points <span class="process-math">\((-1,2,-1)\)</span> and <span class="process-math">\((-1,2,3)\text{.}\)</span>
</div>
</div> <div class="para logical" id="p-224">
<div class="para">The first and last equations intersect in the line</div>
<div class="displaymath process-math">
\begin{equation*}
\left[ \begin{matrix} x\\ y\\z \end{matrix} \right] =
\left[\begin{matrix} 1/2-z\\ 1/2\\z \end{matrix} \right]=
\left[\begin{matrix} 1/2\\ 1/2\\0 \end{matrix} \right] +z\left[\begin{matrix} -1\\ 0\\1 \end{matrix} \right].
\end{equation*}
</div>
<div class="para">Here <span class="process-math">\(x=-2,2\)</span> when <span class="process-math">\(t=5/2,-3/2\)</span> giving us the points <span class="process-math">\((-2,1/2,5/2)\)</span> and <span class="process-math">\((2,1/2,-3/2)\text{.}\)</span>
</div>
</div> <div class="para" id="p-225">Recall to plot the lines between two points we create arrays of the <span class="process-math">\(x\)</span>-values, <span class="process-math">\(y\)</span>-values, and <span class="process-math">\(z\)</span>-values, then plot the line between them.</div>
</div></div> <pre class="ptx-sagecell sagecell-python" id="sage-53"><script type="text/x-sage">import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure() #create a figure
ax = plt.axes(projection='3d') #add a 3D axis

#plot the 3 plane equations, use alpha for transparency
X = np.arange(-2,2,step=0.25) #1d x inputs
Y = np.arange(-2,2,step=0.25) #1d y inputs
X,Y = np.meshgrid(X,Y) #2D grid of inputs
SurfZ1 = 1-X-Y
SurfZ2 = 1+Y
SurfZ3 = Y-X
ax.plot_surface(X,Y,SurfZ1, color='cyan', alpha=0.5) 
ax.plot_surface(X,Y,SurfZ2, color='orchid', alpha=0.5)
ax.plot_surface(X,Y,SurfZ3, color='gold', alpha=0.5)

#plot the solution
ax.scatter(-1,1/2,3/2)

#plot the 3 line equations using points
Line1X = [-2,2] #xvalues for first line
Line1Y = [1,-1] #yvalues for first line
Line1Z = [2,0] #zvalues for first line
Line2X = [-1,-1]
Line2Y = [-2,2]
Line2Z = [-1,3]
Line3X = [-2,2]
Line3Y = [1/2,1/2]
Line3Z = [5/2,-3/2]
ax.plot(Line1X,Line1Y,Line1Z, color='mediumpurple')
ax.plot(Line2X,Line2Y,Line2Z, color='darkorange')
ax.plot(Line3X,Line3Y,Line3Z, color='green')

# Customize the view angle 
#ax.view_init(elev=20, azim=30, roll=0)

#set title and axes labels
ax.set(title="Solutions to 3D System", xlabel="x", ylabel="y", zlabel="z")

plt.show()
</script></pre> <div class="para" id="p-226">Can you find other fixes? <em class="emphasis">If so, share them so we can add them here.</em>
</div></article></section><section class="subsection" id="subsection-26"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber"></span> <span class="title">Graphing vector equations and their solutions</span>
</h3>
<div class="para" id="p-227">Recall that solving a vector equation is equivalent to solving a system of equations.</div>
<article class="example example-like" id="example-4"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.9</span><span class="period">.</span>
</h4>
<div class="para logical" id="p-228">
<div class="para">For example the vector equation</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/twodsolutions.html">
\begin{equation*}
x\left[ \begin{matrix} 1\\ 1/2 \end{matrix} \right] +
y\left[\begin{matrix} 2\\-1 \end{matrix} \right]=
\left[\begin{matrix} 6\\1 \end{matrix} \right]
\end{equation*}
</div>
<div class="para">corresponds to the linear system found in <a href="" class="xref" data-knowl="./knowl/twodsolutions.html" title="Example 2.6">Example¬†2.6</a> and still has solution <span class="process-math">\(x=4\)</span> and <span class="process-math">\(y=1\text{.}\)</span>
</div>
</div> <div class="para" id="p-229">The solution to the vector equation can be graphed using linear combinations of vectors. That is, <span class="process-math">\(4\vec{u}+\vec{v}=\vec{b}.\)</span>
</div> <pre class="ptx-sagecell sagecell-python" id="sage-54"><script type="text/x-sage">import matplotlib.pyplot as plt

fig = plt.figure(figsize=(8,5)) #create a figure
#create one row and two columns of plots
ax1 = plt.subplot(1,2,1) #1 row, 2 columns, first graph
ax2 = plt.subplot(1,2,2) #1 row, 2 columns, second graph

# add original vectors to axes
ax1.quiver(0,0,1,1/2,label='$\\vec u$',color='darkgoldenrod', angles='xy', scale_units='xy', scale=1) 
ax1.quiver(0,0,2,-1,label='$\\vec v$',color='deepskyblue', angles='xy', scale_units='xy', scale=1) 
ax1.quiver(0,0,6,1,label='$\\vec b$',color='green', angles='xy', scale_units='xy', scale=1) 

#add solution vectors to axes
ax2.quiver(0,0,4,2,label='$4 \\vec u$',color='darkgoldenrod', angles='xy', scale_units='xy', scale=1, alpha=0.6) 
ax2.quiver(4,2,2,-1,label='$\\vec v$', color='deepskyblue', angles='xy', scale_units='xy', scale=1)
ax2.quiver(0,0,6,1,label='$\\vec b$',color='green', angles='xy', scale_units='xy', scale=1) 

#annotate vectors option instead of legend
ax1.annotate("$\\vec u$", xy=(0.25,0.25))
ax1.annotate("$\\vec v$", xy=(0.5, -.65))
ax1.annotate("$\\vec b$", xy=(3, 0.25))
ax2.annotate("$4\\vec u$", xy=(2,1.2))
ax2.annotate("$\\vec v$", xy=(5,1.65))
ax2.annotate("$\\vec b$", xy=(3, 0.25))

#set title and axes labels and limits, legend, axis, grid
ax1.set(title="Vector Equation $x\\vec u+y\\vec v=\\vec b$")
ax1.set(xlabel="x", ylabel="y")
ax1.set(xlim=(-1,7), ylim=(-1.5,3.5))
ax1.legend() 
ax1.axhline(0, color='black')
ax1.axvline(0, color='black')
ax1.grid()

#set title and axes labels and limits, legend, axis, grid
ax2.set(title="Vector Equation Solutions", xlabel="x", ylabel="y")
ax2.set(xlim=(-1,7), ylim=(-1.5,3.5))
ax2.legend() 
ax2.axhline(0, color='black')
ax2.axvline(0, color='black')
ax2.grid() 

plt.show()
</script></pre></article></section><section class="subsection" id="subsec-"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber"></span> <span class="title">Converting between Numpy arrays and Sympy Matrices</span>
</h3>
<div class="para" id="p-230">Since Numpy and Sympy are different libraries, we will need to either enter our augmented matrix as a Sympy matrix, or convert a numpy array into a sympy matrix in order to call the row reducing function in Sympy.</div>
<div class="para" id="p-231">Note that Numpy matrices can be coded as 2D Numpy arrays.</div>
<pre class="ptx-sagecell sagecell-python" id="sage-55"><script type="text/x-sage">import numpy as np
import sympy as sp

npA = np.array([[1, 2], [3, 4]]) #Create a numpy array
spA = sp.Matrix(npA) #convert to a sympy matrix

RREF = spA.rref()[0] #Get RREF in sympy

print(RREF) #print sympy rref
print(np.array(RREF)) #print numpy rref, this doesn't always work to compute with
print(np.array(RREF).astype(np.float64)) #specify float type, which will work
</script></pre></section><section class="subsection" id="subsecRoundingErrorRref"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber"></span> <span class="title">Round-off error in Sympy‚Äôs rref()</span>
</h3>
<div class="para" id="p-232">Whenever you use a computer to perform arithmetic you have to consider round-off error. Numbers in Python are either stored as an integer data type, a floating point number data type, or a complex number data type. Although <span class="process-math">\(0.1\)</span> has a finite decimal representation, in binary it requires an infinite repeating floating point representation which cannot be stored without being truncated or rounded.</div>
<article class="example example-like" id="rounderror"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.10</span><span class="period">.</span>
</h4>
<div class="para logical" id="p-233">
<div class="para">Consider the system of equations</div>
<div class="displaymath process-math" id="md-8">
\begin{align*}
0.8x -0.8y -0.4z \amp= 0 \\
-0.3x +0.9y -0.4z \amp =0\\
-0.4x -0.1y +0.8z\amp=0 
\end{align*}
</div>
<div class="para">If you multiply both sides of each equation by 10, you don‚Äôt change the solutions to the equations.</div>
<div class="displaymath process-math" id="md-9">
\begin{align*}
8x -8y -4z \amp= 0 \\
-3x +9y -4z \amp =0\\
-4x -y +8z\amp=0 
\end{align*}
</div>
<div class="para">If you use Sympy to row reduce the system, however, you get a different answer.</div>
</div> <pre class="ptx-sagecell sagecell-python" id="sage-56"><script type="text/x-sage">import sympy as sp

#system of linear equations
S = sp.Matrix([
[ 0.8,-0.8,-0.4 ,0],
[-0.3, 0.9,-0.4, 0],
[-0.5,-0.1, 0.8, 0]])

#same system multiplied by 10
disguised_S = sp.Matrix([
[ 8,-8,-4 ,0],
[-3, 9,-4, 0],
[-5,-1, 8, 0]])

print("Reduced with decimals:", S.rref())
print("Reduced with whole numbers:", disguised_S.rref())
</script></pre> A possible fix for the floating point round-off error is to tell Sympy explicitly when to round to zero by making a user defined <code class="code-inline tex2jax_ignore">iszerofunc</code>. <pre class="ptx-sagecell sagecell-python" id="sage-57"><script type="text/x-sage">import sympy as sp

#system of linear equations
S = sp.Matrix([
[ 0.8,-0.8,-0.4 ,0],
[-0.3, 0.9,-0.4, 0],
[-0.5,-0.1, 0.8, 0]])

#same system multiplied by 10
disguised_S = sp.Matrix([
[ 8,-8,-4 ,0],
[-3, 9,-4, 0],
[-5,-1, 8, 0]])

SRREF = S.rref(iszerofunc=lambda x: abs(x) < 1e-10)

print("Reduced with decimals:", SRREF)
print("Reduced with whole numbers:", disguised_S.rref())
</script></pre></article><article class="exercise exercise-like" id="exercise-49"><h4 class="heading">
<span class="type">You Try</span><span class="space"> </span><span class="codenumber">2.11</span><span class="period">.</span>
</h4>
<div class="para" id="p-234">Sympy‚Äôs rational number data type stores fractions as two integers to avoid floating point representation. Fix the row reduction round-off error for the original system in <a href="" class="xref" data-knowl="./knowl/rounderror.html" title="Example 2.10">Example¬†2.10</a> by using Sympy‚Äôs <code class="code-inline tex2jax_ignore">Rational()</code> function instead.</div></article></section><article class="assemblage assemblage-like" id="assemblage-6"><h3 class="heading"><span class="title">Summary.</span></h3>
<div class="para logical" id="p-235">
<ul class="disc"><li id="li-73"><div class="para" id="p-236">TBD</div></li></ul>
<ul class="disc"><li id="li-74"><div class="para" id="p-237">TBD</div></li></ul>
</div></article><section class="exercises" id="exercises-systems"><h3 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber"></span> <span class="title">Exercises</span>
</h3>
<article class="exercise exercise-like" id="exercise-50"><h4 class="heading"><span class="codenumber">1<span class="period">.</span></span></h4>
<div class="para logical" id="p-238">
<div class="para">The system</div>
<div class="displaymath process-math" id="md-10">
\begin{align*}
x  +2y  +z \amp= 6 \\
x  -y  \amp =3\\
-x  +y  -z\amp =0
\end{align*}
</div>
<div class="para">has a unique solution.</div>
</div>
<div class="para" id="p-239">Use Python code to find the solution. Graph the system of equations and the solution using Matplot3D. Lable your axes. <em class="emphasis">Note: part of the challenge is making sure you have a good viewing window and perspective so the graph helps illuminate the solution.</em>
</div></article><article class="exercise exercise-like" id="exercise-51"><h4 class="heading"><span class="codenumber">2<span class="period">.</span></span></h4>
<div class="para logical" id="p-240">
<div class="para">Consider the system</div>
<div class="displaymath process-math" id="md-11">
\begin{align*}
x  +2y  +z \amp= 6 \\
x  -y  \amp =3\\
-x  +y  -z\amp =0
\end{align*}
</div>
<div class="para">Convert the system of linear equations to a vector equation.</div>
</div>
<div class="para" id="p-241">Find the unique solution and graph your answer as a vector equation using Matplotlib3D. (That is, use vectors instead of planes to visualize the solution to this system.)</div></article></section></section><div class="hidden-content tex2jax_ignore" id="hk-fn-5"><div class="fn">Row reduction is sometimes called Gaussian elimination, after the mathematician Gauss, whose notation was adopted by . The method was actually popularized in Europe by Cambridge University who published notes of Newton. Soon algebra textbooks across Europe included the method. Long before Gauss or Newton, Chinese scholars demonstrated this method of solving systems of linear equations in chapter 8 of The Nine Chapters on the Mathematical Art.</div></div>
<div class="hidden-content tex2jax_ignore" id="hk-fn-6"><div class="fn"><code class="code-inline tex2jax_ignore">Interactive Linear Algebra 1.2 Row Reduction</code></div></div>
</div>
<div class="ptx-content-footer">
<a class="previous-button button" href="chapter2.html" title="Previous"><span class="icon">&lt;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon">^</span><span class="name">Top</span></a><a class="next-button button" href="section-matrices.html" title="Next"><span class="name">Next</span><span class="icon">&gt;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="338 3000 8772 6866"><g style="stroke-width:.025in; stroke:black; fill:none"><polyline points="472,3590 472,9732 " style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png"></a>
</div>
</body>
</html>
