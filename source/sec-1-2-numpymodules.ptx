<?xml version="1.0" encoding="UTF-8" ?>
<!-- This file is part of the book                      -->
<!--                                                    -->
<!-- An Introduction to Matrix Computations in Python   -->
<!--                                                    -->
<!-- Copyright (C) 2023  LBCC                           -->
<!-- See the file copyright.txt for copying conditions. -->

<section xml:id="section-modules">
    
    <title>Python Packages and NumPy</title>

    <introduction>
        Python packages and libraries are collections of functions and modules centered around a common theme. 
        In this section we will learn how to import a Python package and use functions from that package.    
    </introduction>

    <objectives>
        <ul>
          <li>
            <p>
              Import a Python package or library (our example NumPy).
            </p>
          </li>
          <li>
            <p>
              Use functions from a Python package.
            </p>
          </li>
        </ul>
      </objectives>

      <subsection>
        <title>Importing the package NumPy</title>

        <p>
          NumPy is an open source scientific computing package that allows you to use standard 
          mathematical functions and constants like sine or pi. 
          NumPy also allows you to work with arrays of numbers so you can efficiently perform computations. 
        </p>

        <sage language='python'>
          <input>
            #first import the package numpy
            import numpy

            #compute sin(2) 
            x = numpy.sin(2)
            print(x)
          </input>
        </sage>


        <p>
          Note to call a function from an imported package you must use the syntax <c>package.function</c>.
          To avoid retyping the long name of a package every time, it is standard practice to rename the package as you import.  
        </p>

        <exercise>
          <p>
            Rename the package numpy in the above code by
            replacing the import line with <c>import numpy as np</c>. Next use the new name of the package to call the function <c>np.sin()</c> and re-run.
          </p>
        </exercise>

      </subsection>

      <subsection>
        <title>Standard functions in NumPy</title>

        <p>
          In addition to the standard trigonometric functions, 
          NumPy also contains <m>e^x</m> as <c>exp()</c> and natural log as <c>log()</c>, 
          as well as the standard mathematical constants like <c>pi</c> and <c>e</c>.
        </p>

        <exercise>
          <p> Use the NumPy package to compute the area of a circle using pi.  
          </p>

          <hint> If you import numpy as np, you will use np.pi
          </hint>

        </exercise>


        <sage language='python'>
          <input>
            #import the package numpy first - you fill in

            #decide the radius of the circle
            radius = 4
            
            #fill in the formula for the calculation here
            circle_area = 

            print(circle_area)
          </input>
        </sage>

      </subsection>

      <subsection>
        <title>NumPy arrays</title>

        <p>
          NumPy arrays can help us efficiently do computations with a collection of numbers all at once. 
          We can also represent vectors or matrices using NumPy arrays. 
          Run the code below that calls the NumPy function <c>array</c> to see how it works.
        </p>

        <sage language='python'>
          <input>
            import numpy as np
            
            #create an array containing the numbers 1, 2, 3, 4
            X = np.array([1,2,3,4])
            
            print(X)
            print(2*X)
          </input>
        </sage>

        <p>
          NumPy also has built in functions to automatically create an array with certain conditions.
          For example <c>linspace()</c> takes a given interval and sets up an array of evenly spaced numbers on that interval. 
        </p>

        <sage language='python'>
          <input>
            import numpy as np

            #create array of 11 evenly spaced numbers between 0 and 5
            X = np.linspace(0,5,num=11) 
             
            print(X)
          </input>
        </sage>

        <p>
          Note that the array includes 5, so it takes 11 evenly spaced numbers to get numbers 0.5 apart. 
          Note also that although the number values are evenly spaced, the printed array is not. 
          Namely the default is to space out the entries by the maximum number of decimal places with blank spaces instead of extra zeroes. 
        </p>

        <exercise>
          <p>
            Edit the above code to use linspace to create an array of numbers between 0 and 5 that are one-quarter apart. 
            When you evaluate your code should print the list 0, 0.25, 0.5, 0.75, etc.
          </p>
        </exercise>

        <p>
          Another way to create an array of values for a given interval is <c>arange()</c>, which uses a step value to 
          set up a sequence of numbers within that interval. 
        </p>

        <sage language='python'>
          <input>
            import numpy as np

            #create array of numbers between 0 and 5 with step size 2 
            X = np.arange(0,5,step=2) 
             
            print(X)
          </input>
        </sage>

        <p>
          Note that the right endpoint of the interval in <c>arange</c> is always excluded (strictly less than).
        </p>

        <exercise>
          <p>
            Edit the above code to use <c>arange</c> to create an array of numbers between 0 and 5 that are one-quarter apart. 
            When you evaluate your code should print the list 0, 0.25, 0.5, 0.75, etc.          </p>
        </exercise>

        
      </subsection>

      <subsection>
        <title>Selecting and Using Part of an Array</title>
          <p>
            At times you may want just a specific part of an array or to create a new array with 
            part of a larger array. Python has the ability to access a single element by 
            indexing or a range within the array by slicing.
          </p>
            
          <p>
            Accessing a single element by indexing. We can access an specific element of the 
            array using it's index by typing <c>X[index number]</c>. The index number is the position 
            of the element in the array.
          </p>

          <sage language='python'>
            <input>
              import numpy as np
              #create array of 10 evenly spaced numbers between 0 and 5
              X = np.linspace(0,5,num=9)
              print(X)

              #access the first element in the array X
              b=X[0]
              print(b)
            </input>
          </sage>
          <exercise>
            <statement>
              <p>
                You Try It Use the indexing method to access and pring the 4th entry 
                in the array X. Then access and print the 100th entry.
              </p>
            </statement>
          </exercise>
          <sage language='python'>
            <input>
              #create array of 110 evenly spaced numbers between 0 and 10
              X = np.linspace(0,10,num=110)
              print(X)
              
              #access and print the 4th entry
              b=print(b)
              
              #access and print the 100th entry
            </input>
          </sage>
        </subsection>

        <subsection>
          <title>Selecting a Range of Entries in an Array</title>
          <p>
            You can select a range of entries in an array using a method known as slicing.
            Instead of putting a single index number in the brackets we can select a range 
            of values by placing a colon between the starting and stopping index values 
            we want.
          </p>

          <sage language='python'>
            <input>
              import numpy as np
              #create array of 10 evenly spaced numbers between 0 and 5
              X = np.linspace(0,5,num=9)
              print(X)
              #select the first three values of the array X
              Y=X[0:3]
              print(Y)
            </input>
          </sage>

          <exercise>
            <statement>
              <p>
                Create a new array out of the middle 50 values of the array.
              </p>
            </statement>
          </exercise>

          <sage language='python'>
            <input>
              #create array of 110 evenly spaced numbers between 0 and 10
              X = np.linspace(0,10,num=110)
            </input>
          </sage>

        </subsection>


      <subsection> 
        <title>Importing .csv files using the Pandas package</title>
        <p>
          Sometimes we want to import an array from a file or spreadsheet. 
          The Python package, Pandas, was created to manipulate spreadsheet data. 
          While the main object in NumPy is a NumPy array, the main object in the Pandas package is a Pandas dataframe, 
          essentially a table with indexed rows and named columns.
          More information about dataframe (table) manipulation in Pandas will be added to the appendix in 
          future versions of this book.
        </p>
        <p> 
          For now we will just use the Pandas package to import a .csv file as a Pandas dataframe, 
          then convert it into a NumPy array so we can use the computational power of NumPy. 
          Since we don't have a simple way to upload files into the online textbook, the 
          following code must be used in Google Colab, with the file uploaded temporarily to Colab,
          or on your local machine with a local version of Python. 
        </p>

        <sage language='python'>
          <input>
            import numpy as np
            import pandas as pd

            #import the file using pandas read_csv command
            #the file path and filename should be in quotes
            imported_file = pd.read_csv('/content/file.csv')

            #convert the pandas dataframe into a numpy array
            array = imported_file.to_numpy()
          </input>
        </sage>

      </subsection>



      <conclusion>
        <p> You can find more information about the package NumPy at 
          <url href="https://numpy.org/" visual="numpy.org"/>. 
          You can find more information about the package Pandas at 
          <url href="https://pandas.pydata.org/" visual="pandas.pydata.org"/>.
          Python's wiki has a list of other commonly used 
          <url href="https://wiki.python.org/moin/UsefulModules" visual="wiki.python.org/moin/UsefulModules">modules 
            and packages.</url>
        </p>
      </conclusion>


      <assemblage><!--to assemble or summarize important connected ideas-->
        <title> Summary </title>
        <p>
        <ul>
          <li>
            <p>
              You can import a Python package and rename it by using <c>import package as name</c>. 
            </p>
          </li>
          <li>
            <p>
                You can call a function from a package using <c>packagename.function</c>
            </p>
          </li>
          <li>
            <p>
                Numpy arrays can help us efficiently do computations. 
            </p>
          </li>
          <li>
            <p>
                The Numpy functions <c>linspace()</c> and <c>arange()</c> set up an array of values over an interval.
            </p>
          </li>
          <li>
            <p>
              Indexing and slicing a numpy array can be used to access a single entry or a range of entries. 
            </p>
          </li>
          <li>
            <p>
                You can use the Pandas function <c>read_csv</c> to import a .csv file as a 
                Pandas dataframe then convert it into a NumPy array using
                <c>array.to_numpy()</c>.
            </p>
          </li>
        </ul>
      </p>
      </assemblage>

      <exercises xml:id="exercises-modules">
        <exercise>
          <p> Research NumPy</p>
          <ol>
            <li>
              <p>
                Look up how to efficiently create a 15 element array of all <m>1</m>'s.
              </p>
            </li>
            <li>
              <p>
                Use this to create a 15 element array of all <m> 100</m>'s. 
              </p>
            </li>
          </ol>
            
          <sage language='python'>
            <input>
              #
              #
              #
              #
              #
            </input>
          </sage>
          <solution>
            <p>
              <ol>
                <li>
                  <p>
                    There is more than one way to do this. One approach is to use the <c>numpy</c> function <c>ones().</c>
                  </p>
                </li>
                <li>
                  <p>
                    Once you have an array of all 1's, you can multiply it by any number you want. 
                  </p>
                </li>
              </ol>
            </p>
          </solution>
        </exercise>
        
        

        <exercise>
          <p>
          The magnitude of an earthquake is measured using the Richter Scale, which is a logarithmic scale. 
          The amount of energy <m>E</m> in <emph>ergs</emph> an earthquake releases can be determined from the magnitude <m>M</m>
          using the formula 
          </p>
          <me> \log_{10}(E)=11.8+1.5M</me>
          <p>
            The <url href="https://earthquake.usgs.gov/earthquakes/map">USGS</url> 
            website lets you download magnitude data for the 30 most recent earthquakes in the world with magnitude <m>>2.5</m>.  
          </p>
          <p>
            Use Numpy to determine how much energy has been released in the 30 most recent earthquakes. 
            <em>Note that you can copy and paste data from a csv file into SageMathCell. 
              You will just need to then format that data for Numpy.</em>  
          </p>

          <sage language='python'>
            <input>
              #
              #
              #
              #
              #
            </input>
          </sage>
        </exercise>
        
      </exercises>





</section>