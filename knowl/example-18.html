<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "pre.sagecell-sage",
  "linked": true,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script><script>// Make *any* pre with class 'sagecell-python' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "pre.sagecell-python",
  "linked": true,
  "languages": [
    "python"
  ],
  "evalButtonText": "Evaluate (Python)"
});
</script>
</head>
<body class="ignore-math">
<article class="example example-like"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.58</span><span class="period">.</span><span class="space"> </span><span class="title">Diagonalizing A.</span>
</h4> <div class="para logical">
<div class="para">Consider the matrix transformation given by <span class="process-math">\(A = \left[
\begin{matrix}
3 \amp 1  \\
2 \amp 2  \\
\end{matrix}
\right].\)</span> As we saw in <a href="" class="xref" data-knowl="./knowl/eigentransformation.html" title="Example 2.56: Visualizing using an Eigen-basis grid">ExampleÂ 2.56</a>, <span class="process-math">\(A\)</span> has an eigen-basis for <span class="process-math">\(\mathbb{R}^2\text{.}\)</span> Moreover, we found a transformation from the standard basis to those eigenvectors is given by</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/eigentransformation.html">
\begin{equation*}
E =\left[ \begin{matrix} 1 \amp -1  \\  1 \amp 2  \\ \end{matrix} \right]. 
\end{equation*}
</div>
<div class="para">Since the eigenvectors are merely scaled by <span class="process-math">\(A\)</span> we can relate <span class="process-math">\(A\)</span> to a scaling (dilation) matrix coming from the eigenvalues corresponding to the eigenvectors in <span class="process-math">\(E\text{,}\)</span> namely,</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/eigentransformation.html">
\begin{equation*}
D =\left[ \begin{matrix} 4 \amp 0  \\  0 \amp 1  \\ \end{matrix} \right]. 
\end{equation*}
</div>
<div class="para">But the scaling matrix <span class="process-math">\(D\)</span> scales the standard basis vectors by 4 and 1. If we want to instead scale our eigenvectors we can</div>
<ol class="decimal">
<li><div class="para">Transform our eigenbasis vectors to standard basis vectors using <span class="process-math">\(E^{-1}\text{.}\)</span>
</div></li>
<li><div class="para">Scale the target standard basis vectors by the corresponding eigenvalues using <span class="process-math">\(D\text{.}\)</span>
</div></li>
<li><div class="para">Transform back to the eigenbasis grid of <span class="process-math">\(\mathbb{R}^2\)</span> using <span class="process-math">\(E\text{.}\)</span>
</div></li>
</ol>
</div> <div class="para">Since we mapped the eigenvector with eigenvalue of 4 to <span class="process-math">\(\vec{e}_1\)</span> and the eigenvector with eigenvalue of 1 to <span class="process-math">\(\vec{e}_2\text{,}\)</span> we want to scale <span class="process-math">\(\vec{e}_1\)</span> by the eigenvalue of 4 and <span class="process-math">\(\vec{e}_2\)</span> by the eigenvalue of 1. If instead we had swapped those, we would need to swap in both <span class="process-math">\(E\)</span> and <span class="process-math">\(D\text{.}\)</span>
</div> <pre class="ptx-sagecell sagecell-python" id="sage-101"><script type="text/x-sage">import numpy as np
import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec

# Create a figure
fig = plt.figure(figsize=(6, 8))

# Create a gridspec layout
gs = gridspec.GridSpec(3, 2, height_ratios=[1, 1, 2])

#create two rows and three column of plots
ax1 = fig.add_subplot(gs[0, 0])  # First plot in the first row
ax2 = fig.add_subplot(gs[0, 1])  # Second plot in the first row
ax3 = fig.add_subplot(gs[1, 0])  # Third plot in the second row
ax4 = fig.add_subplot(gs[1, 1])  # Fourth plot in the second row
ax5 = fig.add_subplot(gs[2, :])  # Single plot in the third col spanning all rows

A = np.array([[3,1],[2,2]]) #matrix transformation
E = np.array([[1,-1],[1,2]]) #transform standard to eigenbasis
D = np.array([[4,0],[0,1]]) #scaling matrix, scales first by 4, second by 1
eig1 = np.array([1,1]) #eigenvector
eig2 = np.array([-1,2]) #eigenvector
ndots = 9 #determine number of nxn dots
window = 7 #determine viewing window size

#create a grid of xy-values
Xvals = np.linspace(-4,4, num=ndots)
Yvals = np.linspace(-4,4, num=ndots)
X,Y = np.meshgrid(Xvals, Yvals)

#reshape the ndots x ndots grid into an x row and y row
X1 = X.reshape((ndots**2,))#x-value row 
Y1 = Y.reshape((ndots**2,)) #y-value row
#stack the two so each column is a coordinate
xygrid = np.row_stack([X1, Y1]) 

#transform to eigengrid 
eigrid = np.matmul(E,xygrid) # can also use @
#note: the columns of eigrid are xygrid coord transformed to eigenbasis coord

#plot R2 using eigenbasis grid 
ax1.scatter(eigrid[0],eigrid[1], c=eigrid[0])
ax1.quiver(0,0,eig1[0],eig1[1],label='$eigenvector \\vec v_1$', color='purple', angles='xy', scale_units='xy', scale=1) 
ax1.quiver(0,0,eig2[0],eig2[1],label='$eigenvector \\vec v_1$', color='crimson', angles='xy', scale_units='xy', scale=1) 
ax1.set(xlim=(-window,window), ylim=(-window,window), title=r"Eigenbasis grid of $\mathbb{R}^2$")

#use inverse to transform eigengrid to standard grid
Einv = np.linalg.inv(E)
inveigrid = np.matmul(Einv, eigrid)
inveig1 = Einv@eig1
inveig2 = Einv@eig2
#plot result
ax2.scatter(inveigrid[0],inveigrid[1], c=eigrid[0])
ax2.quiver(0,0,inveig1[0],inveig1[1],label='$eigenvector \\vec v_1$', color='purple', angles='xy', scale_units='xy', scale=1) 
ax2.quiver(0,0,inveig2[0],inveig2[1],label='$eigenvector \\vec v_1$', color='crimson', angles='xy', scale_units='xy', scale=1) 
ax2.set(xlim=(-window,window), ylim=(-window,window), title=r"Transform to standard via $E^{-1}$")

#scale the standard grid
scalgrid = np.matmul(D, inveigrid)
scalinveig1 = D@inveig1
scalinveig2 = D@inveig2
#plot result
ax3.scatter(scalgrid[0],scalgrid[1], c=eigrid[0])
ax3.quiver(0,0,scalinveig1[0],scalinveig1[1],label='$eigenvector \\vec v_1$', color='purple', angles='xy', scale_units='xy', scale=1) 
ax3.quiver(0,0,scalinveig2[0],scalinveig2[1],label='$eigenvector \\vec v_1$', color='crimson', angles='xy', scale_units='xy', scale=1) 
ax3.set(xlim=(-window,window), ylim=(-window,window), title=r"Scale by eigenvalues 4 and 1")

#transform scaled grid back to eigengrid
eigscalgrid = np.matmul(E, scalgrid)
scaleig1 = E@scalinveig1
scaleig2 = E@scalinveig2
#plot result
ax4.scatter(eigscalgrid[0],eigscalgrid[1], c=eigrid[0])
ax4.quiver(0,0,scaleig1[0],scaleig1[1],label='$eigenvector \\vec v_1$', color='purple', angles='xy', scale_units='xy', scale=1) 
ax4.quiver(0,0,scaleig2[0],scaleig2[1],label='$eigenvector \\vec v_1$', color='crimson', angles='xy', scale_units='xy', scale=1) 
ax4.set(xlim=(-window,window), ylim=(-window,window), title=r"Transform back via $E$")

#transform standard grid by A via matrix mult
uveigrid = np.matmul(A, eigrid) #can also use @
Aeig1 = A@eig1
Aeig2 = A@eig2

#plot transformed eigengrid directly
ax5.scatter(uveigrid[0],uveigrid[1], c=eigrid[0])
ax5.quiver(0,0,Aeig1[0],Aeig1[1],label='$A \\vec v_1$',color='purple', angles='xy', scale_units='xy', scale=1) 
ax5.quiver(0,0,Aeig2[0],Aeig2[1],label='$A \\vec v_2$',color='crimson', angles='xy', scale_units='xy', scale=1) 
ax5.set(xlim=(-window,window), ylim=(-window,window), title=r"Apply $A$ to the eigenbasis grid directly")
#ax5.legend()

plt.tight_layout()
plt.show()
</script></pre> <div class="para">In other words, the matrix transformation <span class="process-math">\(A = EDE^{-1}\text{.}\)</span>
</div></article><span class="incontext"><a href="section-eigenthings.html#example-18" class="internal">in-context</a></span>
</body>
</html>
